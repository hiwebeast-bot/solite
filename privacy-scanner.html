<!DOCTYPE html>
<html lang="en" class="scroll-smooth dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO & Social Sharing Meta Tags -->
    <title>Privacy Scanner | Solite apps</title>
    <title>Privacy Scanner | Solite</title>
    <meta name="description" content="A free, private tool to scan website source code for trackers, third-party scripts, and potential privacy risks. Paste HTML to analyze instantly in your browser.">
    <link rel="canonical" href="https://solite.in/privacy-scanner.html">
    <meta name="robots" content="index, follow">

    <!-- Open Graph for social + AI -->
    <meta property="og:title" content="Privacy Scanner | Solite apps">
    <meta property="og:title" content="Privacy Scanner | Solite">
    <meta property="og:description" content="Free browser-based privacy scanner. No login, no ads.">
    <meta property="og:url" content="https://solite.in/privacy-scanner.html">
    <meta property="og:site_name" content="Solite App Suite">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://solite.in/assets/privacy-scanner-thumbnail.png">

    <!-- AdSense Meta Tag -->
    <meta name="google-adsense-account" content="ca-pub-6623613371208692">

    <!-- Vercel Analytics -->
    <script>
        window.va = window.va || function () { (window.va.q = window.va.q || []).push(arguments); };
    </script>
    <script src="/_vercel/insights/script.js" defer></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
    
    <!-- Schema.org Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Privacy Scanner",
      "url": "https://solite.in/privacy-scanner.html",
      "description": "A free, privacy-first, browser-based privacy scanner with code export.",
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "All",
      "browserRequirements": "Requires JavaScript. Works fully client-side.",
      "creator": {
        "@type": "Organization",
        "name": "Solite",
        "url": "https://solite.in"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <style>
        /* Custom Scrollbar for Webkit browsers */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #111827; /* gray-900 */
        }
        ::-webkit-scrollbar-thumb {
            background-color: #4b5563; /* gray-600 */
            border-radius: 4px;
        }
        /* Custom Scrollbar for Firefox */
        html { scrollbar-color: #4b5563 #111827; }
    </script>
</head>
<body class="bg-black text-gray-200 flex flex-col min-h-screen font-sans">
    
    <!-- Header -->
    <header class="p-3 sm:p-4 w-full flex-shrink-0 sticky top-0 bg-white/80 dark:bg-black/80 backdrop-blur-xl z-30 border-b border-gray-200 dark:border-gray-800">
        <div class="flex justify-between items-center">
            <a href="index.html" class="flex items-center space-x-3" aria-label="Solite Homepage">
                 <svg class="h-8 w-8 text-gray-900 dark:text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2L2 7l10 5 10-5L12 2z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 7l10 5 10-5"/>
                </svg>
                <span class="text-xl font-bold text-gray-900 dark:text-white uppercase tracking-wider">Solite</span>
                <span class="h-6 w-px bg-gray-300 dark:bg-gray-700"></span>
                <span class="text-lg font-semibold text-gray-600 dark:text-gray-400">Privacy Scanner</span>
            </a>
             <div class="flex items-center space-x-4">
                <a href="index.html#apps" class="bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-800 dark:text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center space-x-1.5">
                    <span>Free apps</span>
                    <svg class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5-5 5" /></svg>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow flex h-screen-minus-header">
        <div class="flex-grow w-full lg:w-[80%] p-3 flex flex-col">
            <h1 class="sr-only">Privacy Scanner</h1>
            <div class="flex-grow flex flex-col lg:flex-row gap-4">
                <!-- Input Panel -->
                <div class="flex-1 flex flex-col bg-gray-900 rounded-xl border border-gray-800 p-6 space-y-4">
                    <div class="space-y-2">
                        <h2 class="text-xl font-bold text-white">Scan a Website</h2>
                        <div class="flex gap-2">
                            <input type="url" id="url-input" aria-label="URL Input" placeholder="Enter a URL to get instructions..." class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white/50">
                        </div>
                        <div id="url-instructions" class="hidden text-sm text-yellow-400 bg-yellow-900/20 border border-yellow-500/30 p-3 rounded-lg">
                            <p><strong>To scan privately:</strong></p>
                            <ol class="list-decimal list-inside mt-1 space-y-1">
                                <li>Open the URL in a new tab.</li>
                                <li>Right-click on the page and select "View Page Source".</li>
                                <li>Copy the entire source code and paste it into the text area below.</li>
                            </ol>
                        </div>
                    </div>
                    <textarea id="input-html" aria-label="HTML Source Code Input" class="w-full flex-grow p-4 rounded-lg bg-gray-800 border border-gray-700 text-gray-300 focus:outline-none focus:ring-2 focus:ring-white/50 font-mono text-sm" placeholder="...or paste HTML source code here to begin scanning."></textarea>
                </div>

                <!-- Output Panel -->
                <div class="w-full lg:w-96 flex-shrink-0 bg-gray-900 rounded-xl border border-gray-800 p-6 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-white">Scan Results</h2>
                        <button id="clear-btn" class="bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-lg">Clear</button>
                    </div>
                    <div id="results-container" class="flex-grow overflow-y-auto space-y-4">
                        <div id="results-prompt" class="text-center text-gray-500 pt-16">
                            <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
                            <p class="mt-2">Results will appear here.</p>
                        </div>
                        <!-- Results will be injected here -->
                    </div>
                </div>
            </div>
        </div>
        <!-- Ad Sidebar -->
        <aside class="w-[20%] flex-shrink-0 p-3 border-l border-gray-800 hidden lg:block">
            <div class="h-full bg-gray-800/50 rounded-lg flex items-center justify-center text-gray-400">
                Ad Area
            </div>
        </aside>
    </main>

    <footer class="p-4 w-full flex-shrink-0 border-t border-gray-200 dark:border-gray-700/50">
        <div class="flex flex-col sm:flex-row justify-between items-center text-gray-500 dark:text-gray-400 text-sm">
             <div class="flex items-center space-x-3 mb-4 sm:mb-0">
                <svg class="h-6 w-6 text-gray-400 dark:text-gray-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5L12 2z"/><path d="M2 17l10 5 10-5"/><path d="M2 7l10 5 10-5"/></svg>
                <span>&copy; 2024 Solite. All Rights Reserved.</span>
            </div>
            <div class="flex items-center space-x-4">
                <a href="./privacy.html" class="hover:text-gray-900 dark:hover:text-white transition-colors">Privacy Policy</a>
                <a href="./terms.html" class="hover:text-gray-900 dark:hover:text-white transition-colors">Terms</a>
                <a href="mailto:support@solite.com" class="hover:text-gray-900 dark:hover:text-white transition-colors">Contact</a>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputHtml = document.getElementById('input-html');
            const resultsContainer = document.getElementById('results-container');
            const resultsPrompt = document.getElementById('results-prompt');
            const clearBtn = document.getElementById('clear-btn');
            const urlInput = document.getElementById('url-input');
            const urlInstructions = document.getElementById('url-instructions');

            const KNOWN_TRACKERS = {
                social: [
                'facebook.net', 'connect.facebook.net', 'fbq.js',
                'analytics.twitter.com', 'platform.twitter.com',
                'linkedin.com/px', 'ads.linkedin.com'
                ],
                analytics: [
                'google-analytics.com', 'googletagmanager.com', 'doubleclick.net',
                'hotjar.com', 'clarity.ms', 'bing.com', 'analytics.twitter.com',
                'scorecardresearch.com', 'quantserve.com', 'adsystem.com',
                'criteo.com', 'addthis.com', 'sharethis.com', 'outbrain.com', 'taboola.com',
                'amazon-adsystem.com', 'adsystem.com'
                ],
                fingerprinting: [
                    'fingerprintjs.com', 'fingerprint.com'
                ],
                miners: [
                    'coinhive.com', 'coin-hive.com', 'cryptoloot.pro', 'webmine.pro'
                ],
                fonts: [
                    'fonts.googleapis.com', 'use.typekit.net', 'fonts.adobe.com'
                ]
            };

            const debounce = (func, delay = 300) => {
                let timeout;
                return (...args) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func.apply(this, args), delay);
                };
            };

            const scanHtml = () => {
                const html = inputHtml.value;
                if (!html.trim()) {
                    resultsContainer.innerHTML = '';
                    resultsContainer.appendChild(resultsPrompt);
                    return;
                }

                resultsPrompt.classList.add('hidden');
                resultsContainer.innerHTML = '';

                renderCookieInfoCard();
                runHighRiskScans(html);
                runMediumRiskScans(html);
                runInformationalScans(html);

                // Final "All Clear" message if nothing was found
                if (resultsContainer.children.length <= 1) { // Only cookie card is present
                    renderResultCard('All Clear!', ['No common trackers or major privacy risks were found in the provided HTML.'], 'green');
                }
            };

            function runHighRiskScans(html) {
                const foundMiners = new Set(KNOWN_TRACKERS.miners.filter(d => html.includes(d)));
                renderResultCard('Cryptocurrency Miners', [...foundMiners], 'red');

                const foundFingerprinters = new Set(KNOWN_TRACKERS.fingerprinting.filter(d => html.includes(d)));
                renderResultCard('Browser Fingerprinting', [...foundFingerprinters], 'red');

                const formMatches = html.match(/<form[^>]+action="http:\/\/([^"]+)"/gi) || [];
                const insecureForms = formMatches.map(match => match.match(/action="([^"]+)"/)[1]);
                renderResultCard('Insecure Form Submissions', insecureForms, 'red');
            }

            function runMediumRiskScans(html) {
                const foundSocialTrackers = new Set(KNOWN_TRACKERS.social.filter(d => html.includes(d)));
                renderResultCard('Social Media Trackers', [...foundSocialTrackers], 'yellow');

                const foundAnalyticsTrackers = new Set(KNOWN_TRACKERS.analytics.filter(d => html.includes(d)));
                renderResultCard('Analytics & Ad Trackers', [...foundAnalyticsTrackers], 'yellow');

                const iframeMatches = html.match(/<iframe[^>]+src="([^"]+)"/gi) || [];
                const thirdPartyIframes = iframeMatches.map(match => match.match(/src="([^"]+)"/)[1]).filter(src => !src.startsWith(window.location.origin) && !src.startsWith('/'));
                renderResultCard('Third-Party iFrames', thirdPartyIframes, 'yellow');

                const mixedContentMatches = html.match(/(src|href)="http:\/\/([^"]+)"/gi) || [];
                const insecureResources = mixedContentMatches.map(match => match.match(/"(http:\/\/[^"]+)"/)[1]).filter(src => src.startsWith('http://'));
                renderResultCard('Mixed Content Warnings (HTTP)', insecureResources, 'yellow');

                const linkMatches = html.match(/<a[^>]+target=["']?_blank["']?[^>]*>/gi) || [];
                const insecureLinks = linkMatches.filter(link => !/rel=["']?[^"']*noopener/i.test(link)).map(link => link.match(/href=["']([^"']+)["']/)?.[1] || 'Unknown Link');
                renderResultCard('Insecure External Links', insecureLinks, 'yellow');

                if (/navigator\.sendBeacon/.test(html)) {
                    renderResultCard('Potential Tracking API', ['This page may use `navigator.sendBeacon` to send analytics data as you leave.'], 'yellow');
                }
            }

            function runInformationalScans(html) {
                const usesLocalStorage = /localStorage\.(setItem|getItem)/.test(html);
                const usesSessionStorage = /sessionStorage\.(setItem|getItem)/.test(html);
                renderStorageCard(usesLocalStorage, usesSessionStorage);

                const foundFontServices = new Set(KNOWN_TRACKERS.fonts.filter(d => html.includes(d)));
                renderResultCard('External Font Services', [...foundFontServices], 'blue');
            }

            const renderStorageCard = (usesLocal, usesSession) => {
                if (!usesLocal && !usesSession) return;

                let items = [];
                if (usesLocal) items.push('<li>This page may use <strong>Local Storage</strong> to store data persistently in your browser.</li>');
                if (usesSession) items.push('<li>This page may use <strong>Session Storage</strong> to store data for this session.</li>');

                const card = document.createElement('div');
                card.className = `p-4 rounded-lg bg-blue-900/20 border border-blue-500/30`;
                card.innerHTML = `
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold text-white">Browser Storage Usage</h3>
                        <span class="text-sm font-medium text-blue-400">Informational</span>
                    </div>
                    <ul class="mt-2 text-sm text-gray-300 list-disc list-inside space-y-1">${items.join('')}</ul>
                `;
                resultsContainer.appendChild(card);
            };

            const renderCookieInfoCard = () => {
                const card = document.createElement('div');
                card.className = `p-4 rounded-lg bg-gray-800/50 border border-gray-700`;
                card.innerHTML = `
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold text-white">About Cookies</h3>
                        <span class="text-sm font-medium text-gray-400">Informational</span>
                    </div>
                    <div class="mt-2 text-sm text-gray-400 space-y-2">
                        <p>Cookies are not in the HTML source, so they can't be detected here. They are set by the server or by JavaScript.</p>
                        <p><strong>To check a site's cookies:</strong> Open Developer apps (F12), go to the "Application" (or "Storage") tab, and find "Cookies" in the sidebar.</p>
                    </div>
                `;
                resultsContainer.appendChild(card);
            };

            const renderResultCard = (title, items, color) => {
                const count = items.length;
                const colorClasses = {
                    red: { bg: 'bg-red-900/20', border: 'border-red-500/30', text: 'text-red-400' },
                    yellow: { bg: 'bg-yellow-900/20', border: 'border-yellow-500/30', text: 'text-yellow-400' },
                    green: { bg: 'bg-green-900/20', border: 'border-green-500/30', text: 'text-green-400' },
                    blue: { bg: 'bg-blue-900/20', border: 'border-blue-500/30', text: 'text-blue-400' }
                };
                const classes = colorClasses[color] || colorClasses.yellow;

                const card = document.createElement('div');
                card.className = `p-4 rounded-lg ${classes.bg} border ${classes.border}`;
                
                let itemsHtml = '<p class="text-sm text-gray-400">None found.</p>';
                if (count > 0) {
                    itemsHtml = `<ul class="text-sm text-gray-300 list-disc list-inside space-y-1 font-mono break-all">${items.map(item => `<li>${item.length > 40 ? item.substring(0, 40) + '...' : item}</li>`).join('')}</ul>`;
                }

                card.innerHTML = `
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold text-white">${title}</h3>
                        <span class="text-sm font-bold ${count > 0 ? classes.text : 'text-green-400'}">${count} found</span>
                    </div>
                    <div class="mt-2">${itemsHtml}</div>
                `;
                resultsContainer.appendChild(card);
            };

            inputHtml.addEventListener('input', debounce(scanHtml));

            urlInput.addEventListener('input', () => {
                urlInstructions.classList.toggle('hidden', !urlInput.value.trim().startsWith('http'));
            });

            clearBtn.addEventListener('click', () => {
                inputHtml.value = '';
                urlInput.value = '';
                urlInstructions.classList.add('hidden');
                scanHtml();
            });
        });
    </script>
</body>
</html>